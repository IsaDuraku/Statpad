<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Profile</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="profile-container">
        <h1>User Profile</h1>
        <div class="profile-details">
            <div class="profile-item">
                <span class="label">Full Name:</span>
                <span id="full-name"></span>
            </div>
            <div class="profile-item">
                <span class="label">Username:</span>
                <span id="username"></span>
            </div>
            <div class="profile-item">
                <span class="label">Email:</span>
                <span id="email"></span>
            </div>
            <div class="profile-item">
                <span class="label">Favorite Team:</span>
                <span id="favorite-team"></span>
            </div>
        </div>
    </div>
    <script>
        // Fetch user data using the access token
        const token = getCookie("Authorization");
        if (token) {
            fetchUserData(token);
        } else {
            // Handle unauthorized access
            window.location.href = "/login"; // Redirect to the login page
        }

        // Function to fetch user data from the backend
        function fetchUserData(token) {
            fetch("http://localhost:8080/api/user-profile", {
                method: "GET",
                headers: {
                    Authorization: token,
                },
            })
            .then(response => {
                if (response.status === 200) {
                    return response.json();
                } else {
                    throw new Error("Unauthorized");
                }
            })
            .then(data => {
                // Update the profile details on the page
                document.getElementById("full-name").textContent = data.full_name;
                document.getElementById("username").textContent = data.username;
                document.getElementById("email").textContent = data.email;
                document.getElementById("favorite-team").textContent = data.favorite_team;
            })
            .catch(error => {
                // Handle unauthorized access or other errors
                console.error("Error:", error);
                window.location.href = "/login"; // Redirect to the login page
            });
        }

        // Function to get a cookie by name
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(";").shift();
        }
    </script>
</body>
</html>
<style>body {
    font-family: Arial, sans-serif;
    background-color: #f0f0f0;
    margin: 0;
    padding: 0;
}

.profile-container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    background-color: #fff;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    border-radius: 5px;
    text-align: center;
}

h1 {
    color: #333;
}

.profile-details {
    margin-top: 20px;
}

p {
    font-size: 16px;
    margin: 10px 0;
}

strong {
    font-weight: bold;
}

span {
    color: #007bff;
}
</style>
